##
## Makefile for Cheetah templates
##
SHELL = @SHELL@
INSTALL = @INSTALL@
CHEETAH = @CHEETAH@
WEBROOT = @webroot@

prefix = @prefix@
libdir = @libdir@

targets = $(patsubst %.tmpl,%.py, $(wildcard *.tmpl))
templates = $(wildcard *.py) $(targets)
backups = $(patsubst %.py,%.py_bak, $(targets))

.PHONY: all clean distclean print
.SUFFIXES: .tmpl .py

all: $(templates)
	touch __init__.py

.tmpl.py:
	$(CHEETAH) compile $<

print:
	@echo Sources
	@echo $(targets)
	@echo ---
	@echo Templates
	@echo $(templates)
	@echo --
	@echo Going to $(templatedir)

clean:
	rm -f $(templates)
	rm -f $(backups)

install: $(templates)
	$(INSTALL) -d $(WEBROOT)/lib/templates/
	$(INSTALL) -m 644 $^ $(WEBROOT)/lib/templates/

distclean: clean
	rm -f Makefile
