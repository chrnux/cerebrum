##
## Makefile for Cheetah templates
##
SHELL = @SHELL@
INSTALL = @INSTALL@
CHEETAH = @CHEETAH@
WEBROOT = @webroot@

prefix = @prefix@
libdir = @libdir@

sources = $(wildcard *.tmpl)
templates = $(patsubst %.tmpl,%.py, $(sources))
backups = $(patsubst %.py,%.py_bak, $(templates))

.PHONY: all clean distclean print
.SUFFIXES: .tmpl .py

all: $(templates)

.tmpl.py:
	$(CHEETAH) compile $<

print:
	@echo Sources
	@echo $(sources)
	@echo ---
	@echo Templates
	@echo $(templates)
	@echo --
	@echo Going to $(templatedir)

clean:
	rm -f $(templates)
	rm -f $(backups)

install: $(templates)
	$(INSTALL) -d $(WEBROOT)/lib/templates/
	$(INSTALL) -v -m 644 $^ $(WEBROOT)/lib/templates/

distclean: clean
	rm -f Makefile
