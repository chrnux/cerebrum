## -*- encoding: utf-8 -*-
## Copyright 2004, 2005 University of Oslo, Norway
##
## This file is part of Cerebrum.
##
## Cerebrum is free software; you can redistribute it and/or modify it
## under the terms of the GNU General Public License as published by
## the Free Software Foundation; either version 2 of the License, or
## (at your option) any later version.
##
## Cerebrum is distributed in the hope that it will be useful, but
## WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
## General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with Cerebrum; if not, write to the Free Software Foundation,
## Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
##

#from lib.Main import Main
#from lib.utils import randpasswd
#from lib.utils import get_content_type, get_pragma, get_cache_control
#from FormWidgets import FormWidgets
#import cherrypy
#import gettext
#extends Main

#implements respond
#encoding utf8

#attr $form_widgets = FormWidgets()
#attr $jscripts = ['base.js', 'search.js', 'error.js', 'motd.js']
#attr $messages = []
#attr $_ = gettext.gettext

## The following hack removes the bottom div
#def page_bottom
#end def
## The following hack removes the tabview
#def tabview
#end def

#def header()
<%
content_type=get_content_type()
cherrypy.response.headerMap['Content-Type']= content_type

pragma=get_pragma()
cache_control=get_cache_control()

cherrypy.response.headerMap['Pragma'] = pragma
cherrypy.response.headerMap['Cache-Control'] = cache_control
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
        <title>$_('Activate user account')</title>
        <meta http-equiv="Content-Type" content="$content_type" />
        <meta http-equiv="Pragma" content="$pragma" />
        <meta http-equiv="Cache-Control" content="$cache_control" />
        <meta http-equiv="content-language" content="nb-NO, en-US" />
        <link rel="shortcut icon" type="image/gif" href="/img/litenmedtekst72.gif"/>
                <!-- Include yui styles -->
        <link rel="stylesheet" type="text/css" charset="utf-8" href="/yui/reset-fonts-grids/reset-fonts-grids.css"/>
        <link rel="stylesheet" type="text/css" charset="utf-8" href="/yui/container/assets/container.css"/>
        <link rel="stylesheet" type="text/css" charset="utf-8" href="/yui/logger/assets/logger.css"/>
        <link rel="stylesheet" type="text/css" charset="utf-8" href="/yui/datatable/assets/datatable.css"/>
        <link rel="stylesheet" type="text/css" charset="utf-8" href="/yui/tabview/assets/tabview.css"/>
        <link rel="stylesheet" type="text/css" charset="utf-8" href="/yui/tabview/assets/border_tabs.css"/> 

        <!-- Include our styles -->
	<link rel="stylesheet" type="text/css" charset="utf-8" href="/css/ntnu.css" />

        <!-- Include yui components -->
        <script type="text/javascript" charset="utf-8" src="/yui/utilities/utilities.js"></script>
        <script type="text/javascript" charset="utf-8" src="/yui/logger/logger-min.js"></script>
        <script type="text/javascript" charset="utf-8" src="/yui/container/container-min.js"></script>
        <script type="text/javascript" charset="utf-8" src="/yui/element/element-beta-min.js"></script>
        <script type="text/javascript" charset="utf-8" src="/yui/datasource/datasource-beta-min.js"></script>
        <script type="text/javascript" charset="utf-8" src="/yui/datatable/datatable-beta-min.js"></script>
        <script type="text/javascript" charset="utf-8" src="/yui/autocomplete/autocomplete-min.js"></script>
        <script type="text/javascript" charset="utf-8" src="/yui/tabview/tabview-min.js"></script> 

        <!-- Include our javascript application -->
        <!-- $len($jscripts) -->
        #for $i in $jscripts
            <script type="text/javascript" charset="utf-8" src="/jscript/$i"></script>
        #end for
</head>
<body>
        <div class="pagewrap">
            <!--[if lte IE 6]>
            <style type="text/css">
                #ie6msg{border:3px solid #090; margin:8px 0; background:#cfc; color:#000;}
                #ie6msg h4{margin:8px; padding:0;}
                #ie6msg p{margin:8px; padding:0;}
                #ie6msg p a.getie7{font-weight:bold; color:#006;}
                #ie6msg p a.ie6expl{font-weight:normal; color:#006;}
            </style>
            <div id="ie6msg">
            <h4>Du har en gammel versjon av Internet Explorer.</h4>
            <p>
                    Cereweb st&oslash;tter ikke s&aring; gamle nettlesere og vil ikke fungere 100% f&oring;r du oppgraderer.
            </p>
            <p>
                    Du kan gratis <a class="getie7" href="http://www.microsoft.com/norge/windows/downloads/ie/getitnow.mspx" target="_blank">hente en nyere versjon av Internet Explorer</a>.
                    Bruker du en jobb-PC b&oslash;r du kontakte Orakel p&aring; telefon (735) 91500 eller e-post <a href="mailto:orakel@ntnu.no">orakel@ntnu.no</a>.
                </p>
        </div>
            <![endif]-->
     <div class="orginfo">
      NORGES TEKNISKE-NATURVITENSKAPLIGE UNIVERSITET
    </div>
     <div id="topp">
      <img src="/img/BAS_ntnu_logo.png" alt="NTNU" />
    </div>
    <div id="page">
        <h1>$_('NTNU&apos;s database for administering user accounts')</h1>
    #if $messages
        <div class="text">
        #for $mesg in $messages
                $mesg
        #end for
        </div>
    #end if
#end def

#def footer()
    <!-- page -->
    </div>
    <!-- pagewrap -->
    </div>
</body>
</html>
#end def

#def welcome()
$header()
    <h2>
        $_('Congratulations!')
    </h2>
    <div class="text">
        $_('Your are now welcomed to use your account here at NTNU.')
    </div>
    <div class="text">
        $_('You may use the URL <a href="http://bas.ntnu.no/"> (http://bas.ntnu.no/)</a> to examin your accounts, membership of groups, manage groups (if you own several).')
    </div>
    <div class="text">
        $_('You must change your password every N. months,- and of course you may do it right here at this web-page.')
    </div>
$footer()
#end def

#def initpassword()
#set $username = $cherrypy.session.get('username', '')
$header()
  <h2>
    $_('Please enter the password you want to use (5/5)')
    </h2>
  <form method="post" action="/activation/">
    <div>
        <input type="hidden" name="page" value="initpassword" />
    </div>
    <div>
      <table border="0">
        <tr>
            <td>
                <div class="text">
                    $_('Your username is:') <b>$username</b>
                </div>
            </td>
            <td>
                &#x0020;
            </td>
        </tr>
        <tr>
            <td>
                <div class="text">
                    $_('<em>NB!</em>The password will not be shown again. Make sure that you remember the username and password.')
                </div>
            </td>
            <td>
                &#x0020;
            </td>
        </tr>
        <tr>
            <td>
                <div class="text">
                    <ul>
                        <li>
                        $_('The password must be at least 8 characters or more.')
                        </li>
                         <li>
                            $_('The password must be different from your existing password.')
                        </li>
                        <li>$_('The new password must contain at least one character from 3 of the following 4 groups:')
                        </li>
                      </ul>
                </div>
                <div class="text">
                      <ol>
                        <li>$_('Uppercase letters (A-Z)')</li>
                        <li>$_('Lowercase letters (a-z)')</li>
                        <li>$_('Numerals (0-9)')</li>
                        <li>$_('Other characters that are permitted to use (!#()*+,.=?@[]_{}~-)')</li>
                       </ol>
                </div>
            </td>
            <td>
                &#x0020;
            </td>
        </tr>
        <tr>
          <td>
                <div class="text">
                $_('Choose password:')
                </div>
          </td>
          <td>
                <div class="text">
                    $_('Choose a generated password:')
                </div>
            </td>
        </tr>
        <tr>
          <td>

            <div class="required">
                $form_widgets.password('pw1', $_('Password'))
            </div>

            <div class="required">
                $form_widgets.password('pw2', $_('Retype Password'))
            </div>

          </td>
          <td>
            <div class="text">
            #for $i in $range(0,6)
                $randpasswd()<br />
            #end for
            </div>
          </td>
        </tr>
        <tr>
            <td>
            <div class="buttons">
              <input type="submit" name="submit_pw" value="$_('Continue')" />
           </div>
            </td>
            <td>
                &#x0020;
            </td>
        </tr>
      </table>
    </div>
  </form>
$footer()
#end def

#def eula()
$header()
<h2>$_('End user license agreement (4/5)')</h2>
  <form method="post" action="/activation/">
        <div>
            <input type="hidden" name="page" value="eula" />
        </div>
      <div class="text">
        <a href="itreg_no.html" target="itreg">$_('Bokm&aring;l')</a>
        <a href="itreg_en.html" target="itreg">$_('English')</a>
      </div>
    
      <div class="text">
        $_('I confirm that I have read the IT regulations at NTNU and I accept those obligations as the regulations to any moment demands. I also accepts the sanctions that NTNU can put into action when the IT regulations have been violated as stated in the IT regulations paragraph 4.3, 7.1 and 7.2.')
    </div>
    <div class="text">
        $_('I also give permission to that log-information can be used to indentify my use of all it-equipment with those boundaries as stated in the IT regulations paragraph 5.10.')
      </div>

        <div class="required">
	   <label for="godkjent">$_('I accept:')</label>
	   <input type="checkbox" id="godkjent" name="godkjent_logger" />
	 </div>

      <div>
        <input type="submit" name="submit_btn" value="$_('Continue')" />
      </div>
  </form>
$footer()
#end def

#def studentnr()
$header()
<h2>$_('Enter your student identification number (2/5)')</h2>
  <form method="post" action="/activation/">
        <div>
            <input type="hidden" name="page" value="studentnr" />
        </div>
        <div class="text">
            $_('You need to enter your student identification number (6 numerals).')
        </div>

        <div>
	  <label for="studentnummer">$_('Student identification number:')</label>
          <input type="text" id="studentnummer" name="studentnr" />
        </div>

        <div>
            <input type="submit" name="blapp" value="$_('Continue')" />
	</div>
  </form>
$footer()
#end def

#def pinkode()
$header()
<h2>$_('PIN-code (3/5)')</h2>

  <form method="post" action="/activation/">
        <div>
            <input type="hidden" name="page" value="pinkode" />
        </div>
        <div class="text">
            $_('Please, enter your PIN-code (4 numerals).')
        </div>
        <div>
            <label for="pincode">$_('PIN-code:')</label>
            <input maxlength="4" id="pincode" type="text" name="pin" />

        </div>

        <div>
            <input type="submit" id="pinkodeok" name="blapp" value="$_('Continue')" />
	</div>

        <div class="text">
          $_('The pin-code can be found on the invoice for semester fee you have received.')
        </div>
        <div class="text">
            $_('In case you have not received an invoice, contact <a href="http:www.ntnu.no/studentservice/">Studentservice</a>.')
        </div>
  </form>
$footer()
#end def

#def fodselsnr()
$header()
<h2>$_('Norwegian national identification number (1/5)')</h2>
  <form method="post" action="/activation/">
        <div>
            <input type="hidden" name="page" value="fodselsnr" />
        </div>
      <div class="text">
        $_('You have now entered a service that needs authentication.')
      </div>
      <div class="text">
        $_('This procedure is done in 5 steps.')
      </div>
        <div class="text">
        $_('Please enter your norwegian national identification number (11 numerals).')
      </div>

        <div class="text">
        <label for="fnummer">$_('National identification number:')</label>
        <input maxlength="11" type="text" id="fnummer" name="fnr" />
      </div>

        <div>
        <input type="submit" id="fodselsnrok" name="submit" value="$_('Continue')" />
      </div>
  </form>
$footer()
#end def

#def eulaNotApproved()
$header()
<h2>$_('End user license agreement is not approved...')</h2>
    <div class="text">
        $_('Good luck with your studies at NTNU.')
    </div>
$footer()
#end def

#def errorInInput()
$header()
<h2>$_('Error in input-data')</h2>
    <div class="content_text">
        $_('Sorry, there must be an error in the input-data...')
    </div>
$footer()
#end def


#def noUsernameFound()
$header()
<h2>$_('Could not find the user account...')</h2>
    <div class="text">
        $_('Sorry, but a user account was not found.')
    </div>
    <div class="text">
        $_('Some will experience a delay of minimum 1 day before a user account is available.')
    </div>
    <div class="text">
        $_('Please, try again later.')
    </div>
$footer()
#end def


#def choose_language()
<h2>$_('Vennligst velg spr&aring;k/Please choose language.')</h2>

    #set $lang = $cherrypy.session.get('lang', 'en')
  <form method="post" action="/activation/">
    <div>
        <input type="hidden" name="page" value="language" />
    </div>
    <div>
      <label for="thelang">$_('Spr&aring;k/Language:')</label>

      <select id="thelang" name="lang">
        
        <option value="no"
        #if $lang == 'no'
            selected="selected"
        #end if
        >Norsk</option>
        
        <option value="en"
        #if $lang == 'en'
            selected="selected"
        #end if
        >English</option>
      </select>
    </div>

    <div>
      <input type="submit" id="thelangbutton" name="language" value="$_('Continue')" />
    </div>
  </form>
#end def

#def language():
$header()
$choose_language()
$footer()
#end def

#def content()
$header()
## Content
<div class="text">
    $_('You have now reached the page used to activate your user account at NTNU&apos;s computer-systems.')
</div>
$choose_language()

$footer()
#end def

$content()
