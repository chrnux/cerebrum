##
## Makefile for Cheetah-based stylesheets (CSS)
##
SHELL = @SHELL@
INSTALL = @INSTALL@
CHEETAH = @CHEETAH@

prefix = @prefix@
libdir = @libdir@
WEBROOT = @webroot@
cssdir = $(webroot)/css

sources = $(wildcard *.tmpl)
stylesheets = $(patsubst %.tmpl,%.css, $(sources))
backups = $(patsubst %.css,%.css_bak, $(stylesheets))

.PHONY: all clean distclean print

all: $(stylesheets)

$(stylesheets): %.css: %.tmpl 
	$(CHEETAH) fill --oext css $<

print:
	@echo Sources
	@echo $(sources)
	@echo ---
	@echo Templates
	@echo $(stylesheets)
	@echo --
	@echo Going to $(templatedir)

clean:
	rm -f *~ 
	rm -f $(stylesheets)
	rm -f $(backups)

distclean: clean
	rm -f Makefile

install: $(stylesheets)
	$(INSTALL) -d ${WEBROOT}/htdocs/css/
	$(INSTALL) -v -m 644 $^ ${WEBROOT}/htdocs/css/
