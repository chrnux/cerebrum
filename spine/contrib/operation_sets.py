#!/usr/bin/env python

from sets import Set

# This is the auth_operation_sets and auth_operations used at NTNU.
my_self = [
    'Account.get_accounts',
    'Account.get_authentications',
    'Account.get_address',
    'Account.get_addresses',
    'Account.get_create_date',
    'Account.get_creator',
    'Account.get_posix_uid',
    'Account.get_history',
    'Account.get_homes',
    'Account.get_id',
    'Account.get_primary_group',
    'Account.get_direct_groups',
    'Account.get_entity_name',
    'Account.get_expire_date',
    'Account.get_external_id',
    'Account.get_external_ids',
    'Account.get_groups',
    'Account.get_homedir',
    'Account.get_name',
    'Account.get_owner',
    'Account.get_owner_type',
    'Account.get_spreads',
    'Account.get_gecos',
    'Account.get_shell',
    'Account.get_type',
    'Account.is_expired',
    'Account.is_posix',
    'Account.is_quarantined',
    'Account.get_quarantines',
    'Account.set_password',
    'Person.get_accounts',
    'Person.get_active_quarantines',
    'Person.get_address',
    'Person.get_addresses',
    'Person.get_affiliations',
    'Person.get_all_contact_info',
    'Person.get_all_quarantines',
    'Person.get_birth_date',
    'Person.get_cached_full_name',
    'Person.get_contact_info',
    'Person.get_deceased_date',
    'Person.get_description',
    'Person.get_direct_groups',
    'Person.get_email_domain',
    'Person.get_entity_name',
    'Person.get_export_id',
    'Person.get_external_id',
    'Person.get_external_ids',
    'Person.get_gender',
    'Person.get_groups',
    'Person.get_id',
    'Person.get_names',
    'Person.get_primary_account',
    'Person.get_quarantine',
    'Person.get_quarantines',
    'Person.get_spreads',
    'Person.is_quarantined',
    'EmailTarget.get_id',
    'EmailTarget.get_addresses',
    'EmailTarget.get_alias_value',
    'EmailTarget.set_primary_address',
    'EmailTarget.get_entity',
    'EmailTarget.get_id',
    'EmailTarget.get_primary_address',
    'EmailTarget.get_type',
    'EmailTarget.get_using_uid',
    'EmailTarget.set_alias_value',
    'EntityExternalId.get_id_type',
    'EntityExternalId.get_external_id',
]
cereweb_public = [
    'Commands.get_account_by_name', 
    'EmailTargetSearcher.search',
    'EmailTargetSearcher.set_entity',
    'EmailVacationSearcher.search',
    'EmailVacationSearcher.set_target',
    'EmailForwardSearcher.search',
    'EmailForwardSearcher.set_target',
]
cereweb_basic = [
    'AccountAuthentication.get_method',
    'Account.get_description',
    'Account.get_id',
    'Account.get_name',
    'Account.get_type',
    'Account.get_owner',
    'AccountSearcher.add_intersection',
    'AccountSearcher.length',
    'AccountSearcher.search',
    'AccountSearcher.set_name_like',
    'AccountSearcher.set_search_limit',
    'CerewebMotd.get_creator',
    'ChangeLog.get_change_by',
    'ChangeLog.get_change_program',
    'ChangeLog.get_type',
    'ChangeLog.get_timestamp',
    'ChangeLog.get_message',
    'ChangeType.get_type',
    'ChangeType.get_category',
    'Commands.create_cereweb_option', 
    'Commands.find_email_address',
    'Commands.get_date',
    'Commands.get_date_none', 
    'Commands.get_date_now',
    'Commands.get_datetime', 
    'Commands.get_email_domains_by_category', 
    'Commands.get_extentions',
    'Commands.get_group_by_name',
    'Commands.get_last_changelog_id', 
    'Commands.has_extention',
    'Commands.strptime',
    'Disk.get_host',
    'Disk.get_id',
    'Disk.get_path',
    'DiskSearcher.search',
    'EmailTargetSearcher.search',
    'EmailTargetSearcher.set_entity',
    'EmailTargetTypeSearcher.search',
    'EntityExternalIdTypeSearcher.search',
    'Group.get_description',
    'Group.get_description',
    'Group.get_id',
    'Group.get_name',
    'Group.get_type',
    'Group.is_posix',
    'GroupMemberOperationTypeSearcher.search',
    'GroupSearcher.length',
    'GroupSearcher.search',
    'GroupSearcher.set_name_like',
    'GroupSearcher.set_search_limit',
    'Host.get_name',
    'NameTypeSearcher.search',
    'OU.get_acronym',
    'OU.get_display_name',
    'OU.get_id',
    'OU.get_name',
    'OU.get_short_name',
    'OU.get_type',
    'OUPerspectiveTypeSearcher.search',
    'OUSearcher.length',
    'OUSearcher.search',
    'OUSearcher.set_name_like',
    'OUSearcher.set_search_limit',
    'Person.get_accounts',
    'Person.get_cached_full_name',
    'Person.get_id',
    'Person.get_names',
    'Person.get_type',
    'Person.get_type',
    'PersonAffiliationStatusSearcher.search',
    'PersonAffiliationSearcher.set_search_limit',
    'PersonAffiliationSearcher.set_ou',
    'PersonAffiliationSearcher.search',
    'PersonAffiliation.get_person',
    'PersonAffiliation.get_affiliation',
    'PersonAffiliation.get_status',
    'PersonAffiliation.get_source_system',
    'PersonAffiliationStatus.get_name',
    'PersonAffiliationSearcher.length',
    'PersonName.get_person',
    'PersonName.get_name',
    'PersonName.get_name_variant',
    'PersonNameSearcher.set_name_like',
    'PersonNameSearcher.set_name_variant',
    'PersonNameSearcher.set_search_limit',
    'PersonNameSearcher.search',
    'PersonNameSearcher.set_source_system',
    'PersonSearcher.add_intersection',
    'PersonSearcher.length',
    'PersonSearcher.search',
    'PersonSearcher.set_search_limit',
    'SpreadSearcher.search',
]
cereweb_orakel = [
    'Person.set_description',
    'Account.set_password',
]
cereweb_innsyn = [
    'AccountAuthentication.get_account',
    'AccountAuthentication.get_auth_data',
    'AccountAuthentication.get_method',
    'Account.get_accounts',
    'Account.get_active_quarantines',
    'Account.get_address',
    'Account.get_addresses',
    'Account.get_all_quarantines',
    'Account.get_authentications',
    'Account.get_create_date',
    'Account.get_creator',
    'Account.get_description',
    'Account.get_direct_groups',
    'Account.get_entity_name',
    'Account.get_expire_date',
    'Account.get_gecos',
    'Account.get_groups',
    'Account.get_history',
    'Account.get_homedir',
    'Account.get_homes',
    'Account.get_id',
    'Account.get_name',
    'Account.get_notes',
    'Account.get_np_type',
    'Account.get_owner',
    'Account.get_owner_type',
    'Account.get_pg_member_op',
    'Account.get_posix_uid',
    'Account.get_primary_group',
    'Account.get_quarantine',
    'Account.get_quarantines',
    'Account.get_shell',
    'Account.get_spreads',
    'Account.get_type',
    'Account.is_expired',
    'Account.is_posix',
    'AccountHome.get_account',
    'AccountHome.get_homedir',
    'AccountHome.get_spread',
    'AccountType.get_description',
    'AccountType.get_id',
    'AccountType.get_name',
    'AccountView.get_dumper_size',
    'AddressType.get_description',
    'AddressType.get_id',
    'AddressType.get_name',
    'AuthenticationType.get_description',
    'AuthenticationType.get_id',
    'AuthenticationType.get_name',
    'AuthOperationCode.get_description',
    'AuthOperationCode.get_id',
    'AuthOperationCode.get_name',
    'AuthOperation.get_id',
    'AuthOperation.get_op',
    'AuthOperation.get_op_set',
    'AuthOperationSet.get_description',
    'AuthOperationSet.get_id',
    'AuthOperationSet.get_name',
    'AuthOperationSet.get_operations',
    'CerewebMotd.get_create_date',
    'CerewebMotd.get_creator',
    'CerewebMotd.get_id',
    'CerewebMotd.get_message',
    'CerewebMotd.get_subject',
    'CerewebOption.get_entity',
    'CerewebOption.get_id',
    'CerewebOption.get_key',
    'CerewebOption.get_section',
    'CerewebOption.get_value',
    'ChangeLog.get_change_by',
    'ChangeLog.get_change_program',
    'ChangeLog.get_description',
    'ChangeLog.get_dest_entity',
    'ChangeLog.get_id',
    'ChangeLog.get_message',
    'ChangeLog.get_params',
    'ChangeLog.get_subject_entity',
    'ChangeLog.get_timestamp',
    'ChangeLog.get_type',
    'ChangeType.get_category',
    'ChangeType.get_id',
    'ChangeType.get_message',
    'ChangeType.get_type',
    'Commands.get_account_by_name',
    'Commands.get_date',
    'Commands.get_date_none',
    'Commands.get_date_now',
    'Commands.get_datetime',
    'Commands.get_email_domain_by_name',
    'Commands.get_email_domains_by_category',
    'Commands.get_extentions',
    'Commands.get_free_uid',
    'Commands.get_group_by_name',
    'Commands.get_last_changelog_id',
    'ContactInfoType.get_description',
    'ContactInfoType.get_id',
    'ContactInfoType.get_name',
    'Date.get_day',
    'Date.get_hour',
    'Date.get_minute',
    'Date.get_month',
    'Date.get_second',
    'Date.get_unix',
    'Date.get_year',
    'Disk.get_accounts',
    'Disk.get_active_quarantines',
    'Disk.get_address',
    'Disk.get_addresses',
    'Disk.get_all_quarantines',
    'Disk.get_description',
    'Disk.get_direct_groups',
    'Disk.get_entity_name',
    'Disk.get_external_id',
    'Disk.get_external_ids',
    'Disk.get_groups',
    'Disk.get_history',
    'Disk.get_host',
    'Disk.get_id',
    'Disk.get_notes',
    'Disk.get_path',
    'Disk.get_quarantine',
    'Disk.get_quarantines',
    'Disk.get_spreads',
    'Disk.get_type',
    'DumpClass.get_dumper_size',
    'EmailAddress.get_change_date',
    'EmailAddress.get_create_date',
    'EmailAddress.get_domain',
    'EmailAddress.get_expire_date',
    'EmailAddress.get_id',
    'EmailAddress.get_local_part',
    'EmailAddress.get_target',
    'EmailDomainCategorization.get_category',
    'EmailDomainCategorization.get_domain',
    'EmailDomainCategory.get_description',
    'EmailDomainCategory.get_domains',
    'EmailDomainCategory.get_id',
    'EmailDomainCategory.get_name',
    'EmailDomain.get_categories',
    'EmailDomain.get_description',
    'EmailDomain.get_id',
    'EmailDomain.get_name',
    'EmailDomain.get_persons',
    'EmailForward.get_enable',
    'EmailForward.get_forward_to',
    'EmailForward.get_target',
    'EmailServerType.get_description',
    'EmailServerType.get_id',
    'EmailServerType.get_name',
    'EmailSpamAction.get_description',
    'EmailSpamAction.get_id',
    'EmailSpamAction.get_name',
    'EmailSpamLevel.get_description',
    'EmailSpamLevel.get_id',
    'EmailSpamLevel.get_level',
    'EmailSpamLevel.get_name',
    'EmailTarget.get_addresses',
    'EmailTarget.get_alias_value',
    'EmailTarget.get_entity',
    'EmailTarget.get_id',
    'EmailTarget.get_primary_address',
    'EmailTarget.get_type',
    'EmailTarget.get_using_uid',
    'EmailTargetType.get_description',
    'EmailTargetType.get_id',
    'EmailTargetType.get_name',
    'EmailVacation.get_enable',
    'EmailVacation.get_end_date',
    'EmailVacation.get_start_date',
    'EmailVacation.get_target',
    'EmailVacation.get_vacation_text',
    'EmailVirusFound.get_description',
    'EmailVirusFound.get_id',
    'EmailVirusFound.get_name',
    'EmailVirusRemoved.get_description',
    'EmailVirusRemoved.get_id',
    'EmailVirusRemoved.get_name',
    'EntityAddress.get_address_text',
    'EntityAddress.get_address_type',
    'EntityAddress.get_city',
    'EntityAddress.get_country',
    'EntityAddress.get_entity',
    'EntityAddress.get_p_o_box',
    'EntityAddress.get_postal_number',
    'EntityAddress.get_source_system',
    'EntityContactInfo.get_description',
    'EntityContactInfo.get_entity',
    'EntityContactInfo.get_preference',
    'EntityContactInfo.get_source_system',
    'EntityContactInfo.get_type',
    'EntityContactInfo.get_value',
    'EntityEmailDomain.get_affiliation',
    'EntityEmailDomain.get_domain',
    'EntityEmailDomain.get_person',
    'EntityExternalId.get_external_id',
    'EntityExternalId.get_id_type',
    'EntityExternalId.get_source_system',
    'Entity.get_accounts',
    'Entity.get_active_quarantines',
    'Entity.get_address',
    'Entity.get_addresses',
    'Entity.get_all_quarantines',
    'Entity.get_direct_groups',
    'Entity.get_entity_name',
    'Entity.get_groups',
    'Entity.get_history',
    'Entity.get_id',
    'Entity.get_notes',
    'Entity.get_quarantine',
    'Entity.get_quarantines',
    'Entity.get_spreads',
    'Entity.get_type',
    'EntityName.get_entity',
    'EntityName.get_name',
    'EntityName.get_value_domain',
    'EntityQuarantine.get_create_date',
    'EntityQuarantine.get_creator',
    'EntityQuarantine.get_description',
    'EntityQuarantine.get_disable_until',
    'EntityQuarantine.get_end_date',
    'EntityQuarantine.get_entity',
    'EntityQuarantine.get_start_date',
    'EntityQuarantine.get_type',
    'EntitySpread.get_entity',
    'EntitySpread.get_entity_type',
    'EntitySpread.get_spread',
    'EntityType.get_description',
    'EntityType.get_id',
    'EntityType.get_name',
    'GenderType.get_description',
    'GenderType.get_id',
    'GenderType.get_name',
    'Group.get_accounts',
    'Group.get_active_quarantines',
    'Group.get_address',
    'Group.get_addresses',
    'Group.get_all_quarantines',
    'Group.get_create_date',
    'Group.get_creator',
    'Group.get_description',
    'Group.get_direct_groups',
    'Group.get_entity_name',
    'Group.get_expire_date',
    'Group.get_external_id',
    'Group.get_external_ids',
    'Group.get_group_members',
    'Group.get_groups',
    'Group.get_history',
    'Group.get_id',
    'Group.get_members',
    'Group.get_name',
    'Group.get_notes',
    'Group.get_posix_gid',
    'Group.get_quarantine',
    'Group.get_quarantines',
    'Group.get_spreads',
    'Group.get_type',
    'Group.get_visibility',
    'GroupMember.get_group',
    'GroupMember.get_member',
    'GroupMember.get_member_type',
    'GroupMember.get_operation',
    'GroupMemberOperationType.get_description',
    'GroupMemberOperationType.get_id',
    'GroupMemberOperationType.get_name',
    'GroupVisibilityType.get_description',
    'GroupVisibilityType.get_id',
    'GroupVisibilityType.get_name',
    'HomeDirectory.get_account',
    'HomeDirectory.get_disk',
    'HomeDirectory.get_home',
    'HomeDirectory.get_id',
    'HomeDirectory.get_path',
    'HomeDirectory.get_status',
    'HomeStatus.get_description',
    'HomeStatus.get_id',
    'HomeStatus.get_name',
    'Host.get_accounts',
    'Host.get_active_quarantines',
    'Host.get_address',
    'Host.get_addresses',
    'Host.get_all_quarantines',
    'Host.get_description',
    'Host.get_direct_groups',
    'Host.get_disks',
    'Host.get_entity_name',
    'Host.get_external_id',
    'Host.get_external_ids',
    'Host.get_groups',
    'Host.get_history',
    'Host.get_id',
    'Host.get_name',
    'Host.get_notes',
    'Host.get_quarantine',
    'Host.get_quarantines',
    'Host.get_spreads',
    'Host.get_type',
    'LanguageType.get_description',
    'LanguageType.get_id',
    'LanguageType.get_name',
    'NameType.get_description',
    'NameType.get_id',
    'NameType.get_name',
    'Note.get_create_date',
    'Note.get_creator',
    'Note.get_description',
    'Note.get_entity',
    'Note.get_id',
    'Note.get_subject',
    'OU.get_accounts',
    'OU.get_acronym',
    'OU.get_acronyms',
    'OU.get_active_quarantines',
    'OU.get_address',
    'OU.get_addresses',
    'OU.get_all_contact_info',
    'OU.get_all_quarantines',
    'OU.get_avdeling',
    'OU.get_children',
    'OU.get_contact_info',
    'OU.get_direct_groups',
    'OU.get_display_name',
    'OU.get_entity_name',
    'OU.get_external_id',
    'OU.get_external_ids',
    'OU.get_fakultet',
    'OU.get_groups',
    'OU.get_history',
    'OU.get_id',
    'OU.get_institusjon',
    'OU.get_institutt',
    'OU.get_katalog_merke',
    'OU.get_landkode',
    'OU.get_name',
    'OU.get_names',
    'OU.get_notes',
    'OU.get_parent',
    'OU.get_quarantine',
    'OU.get_quarantines',
    'OU.get_short_name',
    'OU.get_sort_name',
    'OU.get_spreads',
    'OU.get_stedkode',
    'OU.get_type',
    'OUName.get_acronym',
    'OUName.get_display_name',
    'OUName.get_language',
    'OUName.get_name',
    'OUName.get_ou',
    'OUName.get_short_name',
    'OUName.get_sort_name',
    'OUPerspectiveType.get_description',
    'OUPerspectiveType.get_id',
    'OUPerspectiveType.get_name',
    'OUPerspectiveType.get_roots',
    'OUStructure.get_ou',
    'OUStructure.get_parent',
    'OUStructure.get_perspective',
    'PersonAffiliation.get_affiliation',
    'PersonAffiliation.get_create_date',
    'PersonAffiliation.get_deleted_date',
    'PersonAffiliation.get_description',
    'PersonAffiliation.get_last_date',
    'PersonAffiliation.get_ou',
    'PersonAffiliation.get_person',
    'PersonAffiliation.get_source_system',
    'PersonAffiliation.get_status',
    'PersonAffiliation.marked_for_deletion',
    'PersonAffiliationType.get_description',
    'PersonAffiliationType.get_id',
    'PersonAffiliationType.get_name',
    'Person.get_accounts',
    'Person.get_active_quarantines',
    'Person.get_address',
    'Person.get_addresses',
    'Person.get_affiliations',
    'Person.get_all_contact_info',
    'Person.get_all_quarantines',
    'Person.get_birth_date',
    'Person.get_cached_full_name',
    'Person.get_contact_info',
    'Person.get_deceased_date',
    'Person.get_description',
    'Person.get_direct_groups',
    'Person.get_email_domain',
    'Person.get_entity_name',
    'Person.get_export_id',
    'Person.get_external_ids',
    'Person.get_gender',
    'Person.get_groups',
    'Person.get_history',
    'Person.get_id',
    'Person.get_names',
    'Person.get_notes',
    'Person.get_primary_account',
    'Person.get_quarantine',
    'Person.get_quarantines',
    'Person.get_spreads',
    'Person.get_type',
    'PersonName.get_name',
    'PersonName.get_name_variant',
    'PersonName.get_person',
    'PersonName.get_source_system',
    'PosixShell.get_id',
    'PosixShell.get_name',
    'PosixShell.get_shell',
    'PrimaryEmailAddress.get_address',
    'PrimaryEmailAddress.get_target',
    'QuarantineType.get_description',
    'QuarantineType.get_id',
    'QuarantineType.get_name',
    'RequestCode.get_description',
    'RequestCode.get_id',
    'RequestCode.get_name',
    'Request.get_destination',
    'Request.get_entity',
    'Request.get_id',
    'Request.get_operation',
    'Request.get_requester',
    'Request.get_run_at',
    'Request.get_state_data',
    'SearchClass.get_search_objects',
    'SourceSystem.get_description',
    'SourceSystem.get_id',
    'SourceSystem.get_name',
    'Spread.get_description',
    'Spread.get_id',
    'Spread.get_name',
    'Transaction.get_account_type',
    'Transaction.get_address_type',
    'Transaction.get_authentication_type',
    'Transaction.get_auth_operation_code',
    'Transaction.get_contact_info_type',
    'Transaction.get_email_domain_category',
    'Transaction.get_email_server_type',
    'Transaction.get_email_spam_action',
    'Transaction.get_email_spam_level',
    'Transaction.get_email_target_type',
    'Transaction.get_email_virus_found',
    'Transaction.get_email_virus_removed',
    'Transaction.get_encoding',
    'Transaction.get_entity_external_id_type',
    'Transaction.get_entity_type',
    'Transaction.get_gender_type',
    'Transaction.get_group_member_operation_type',
    'Transaction.get_group_visibility_type',
    'Transaction.get_home_status',
    'Transaction.get_language_type',
    'Transaction.get_name_type',
    'Transaction.get_ou_perspective_type',
    'Transaction.get_person_affiliation_type',
    'Transaction.get_posix_shell',
    'Transaction.get_quarantine_type',
    'Transaction.get_request_code',
    'Transaction.get_source_system',
    'Transaction.get_spread',
    'Transaction.get_value_domain',
    'ValueDomain.get_description',
    'ValueDomain.get_id',
    'ValueDomain.get_name',
    'View.get_accounts',
    'View.get_accounts_cl',
    'View.get_groups',
    'View.get_groups_cl',
    'View.get_ous',
    'View.get_ous_cl',
    'View.get_persons',
    'View.get_persons_cl',
]

operation_sets = {
    'cereweb_public': {
      'desc': 'operations all users should be allowed to do',
      'codestrs': cereweb_public},
    'cereweb_basic': {
      'desc': 'operations only trusted users should be allowed to do',
      'codestrs': cereweb_basic},
    'cereweb_orakel': {
      'desc': 'operations that the orakel-group should be allowed to do on users in a given affiliation',
      'codestrs': cereweb_innsyn + cereweb_orakel},
    'cereweb_innsyn': {
      'desc': 'all read operations available',
      'codestrs': cereweb_innsyn},
    'cereweb_self': {
      'desc': 'operations all users should be allowed to do with their own account',
      'codestrs': my_self},
}

# target_type, entity_id, attr
operation_targets = {
    'cereweb_self': [('my_account', None, None),
                     ('my_person', None, None),
                     ('my_group', None, None),
                     ('my_email', None, None)],
    'cereweb_orakel': [('account', 15850, 'TILKNYTTET'),
                       ('person', 15850, 'TILKNYTTET'),
                       ('ou', 15850, None)],
    'cereweb_basic': [('global', None, None)],
    'cereweb_public': [('global', None, None)],
}

# vim: se foldmarker=[,]:
